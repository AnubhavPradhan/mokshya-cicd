# Codebase Recon and Secret Discovery

---

## Target
**Repository**: `github.com/oktadev/schematics`  

**Objective**: Identify security flaws, leaked secrets, and disclosure-worthy artifacts using static code scanning and Git history analysis.  

---

## Recon & Audit Workflow

| Task                   | Tool/Mode          | Summary                                                    |
|------------------------|-------------------|------------------------------------------------------------|
| **Clone Public GitHub Repo** | `clone_repository` | Cloned successfully to analyze file structure              |
| **Source File Discovery**    | `list_source_files` | >100 TypeScript, JavaScript, Angular, React, Vue, Express files |
| **Static Code Audit**        | `audit_repository`  | ✅ No logic-level vulnerabilities detected                  |
| **Secrets Detection**        | `trufflehog_scan`   | ❗ 32 exposed secrets detected in Git history               |
| **Reporting Prep**           | Manual classification | Secrets tagged, risk-rated, and advisory created           |

---

## Tabular Summary: Can These Be Reported?

| Finding                          | Type   | Risk Level | File(s)             | Reportable (Bug Bounty) | Notes                                                |
|----------------------------------|--------|------------|---------------------|--------------------------|------------------------------------------------------|
| **Snyk API Key** (`dcdefa68-...`) | Secret | High       | `package-lock.json` | ❌ No                   | False Positive                                       |
| **Box API Token** (`cbt8BcI0...`) | Secret | High       | `package-lock.json` | ❌ No                   | False Positive                                       |
| **No traditional code vulnerabilities** | Code   | None       | N/A                 | ❌ No                   | Secure usage patterns observed                       |
| **Repeated leakage across commits** | Hygiene | High       | Git history         | ✅ Yes (if key reuse)   | Indicates lack of history sanitization & CI lapses   |

---

## Additional Observations
- Git history shows **multiple reintroductions of the same secrets** → flawed commit hygiene or improperly configured secret scanning in CI.  
- **Automation bots (e.g., Snyk-bot)** authored several key-leaking commits.  
- No vulnerable dependencies or logic-level bugs (e.g., SQLi, RCE, IDOR) were found during static audit.  

---

## Recommendations

| Action                                   | Priority | Description                                   |
|------------------------------------------|----------|-----------------------------------------------|
| **Rotate all leaked credentials**        | High     | Treat all as compromised                      |
| **Purge Git history (BFG/filter-branch)**| High     | Prevent resurfacing in forks/clones           |
| **Set up GHAS or TruffleHog in CI**      | Medium   | Catch leaks before PR merge                   |
| **Add `.gitattributes` and `.gitignore`**| Low      | Prevent future lockfile/token leakage         |

---
